format_labeller = function(variable, value) {
format_labels <- list(
2 = "2 (folio)",
# Or a faceted lined graph
format_labeller = function(variable, value) {
format_labels <- list(
"2" = "2 (folio)",
"4" = "4 (quarto)",
"8" = "8 (octavo)",
"12" = "12 (duodecimo)"
)
out = format_labels[value]
return(out)
}
transactions %>%
filter(!is.na(edition)) %>%
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
ggplot(aes(order_year, num_vols_exchanged)) +
facet_wrap(~edition, scales = "free_y", labeller = labeller(num_vols_exchanged = format_labeller)) +
scale_x_continuous(breaks = seq(1770, 1794, by = 4)) +
geom_line() +
labs(
title = "Demand for all formats except folio peaked in the late 70s or early 80s",
subtitle = "Number of volumes exchaged by number of leaves"
)
# Or a faceted lined graph
format_labeller = function(variable, value) {
format_labels <- list(
"2" = "2 (folio)",
"4" = "4 (quarto)",
"8" = "8 (octavo)",
"12" = "12 (duodecimo)"
)
value = as.character(value)
out = format_labels[value]
return(out)
}
transactions %>%
filter(!is.na(edition)) %>%
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
ggplot(aes(order_year, num_vols_exchanged)) +
facet_wrap(~edition, scales = "free_y", labeller = labeller(num_vols_exchanged = format_labeller)) +
scale_x_continuous(breaks = seq(1770, 1794, by = 4)) +
geom_line() +
labs(
title = "Demand for all formats except folio peaked in the late 70s or early 80s",
subtitle = "Number of volumes exchaged by number of leaves"
)
# Or a faceted lined graph
format_labeller = as_labeller(c(
"2" = "2 (folio)",
"4" = "4 (quarto)",
"8" = "8 (octavo)",
"12" = "12 (duodecimo)"
))
transactions %>%
filter(!is.na(edition)) %>%
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
ggplot(aes(order_year, num_vols_exchanged)) +
facet_wrap(~edition, scales = "free_y", labeller = labeller(num_vols_exchanged = format_labeller)) +
scale_x_continuous(breaks = seq(1770, 1794, by = 4)) +
geom_line() +
labs(
title = "Demand for all formats except folio peaked in the late 70s or early 80s",
subtitle = "Number of volumes exchaged by number of leaves"
)
# Or a faceted lined graph
format_labeller = as_labeller(c(
"2" = "2 (folio)",
"4" = "4 (quarto)",
"8" = "8 (octavo)",
"12" = "12 (duodecimo)"
))
transactions %>%
filter(!is.na(edition)) %>%
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
ggplot(aes(order_year, num_vols_exchanged)) +
facet_wrap(~edition, scales = "free_y", labeller = format_labeller) +
scale_x_continuous(breaks = seq(1770, 1794, by = 4)) +
geom_line() +
labs(
title = "Demand for all formats except folio peaked in the late 70s or early 80s",
subtitle = "Number of volumes exchaged by number of leaves"
)
yearly_data %<>%
left_join(num_known) %>%
mutate(revised = sheets_needed / known_vols)
yearly_data
yearly_data %>%
select(-known_vols) %>%
gather(metric, measure, -order_year) %>%
ggplot(aes(order_year, measure, color = metric)) +
geom_line() +
scale_y_continuous(labels = comma) +
scale_x_continuous(breaks = seq(1770, 1794, by = 4)) +
scale_color_discrete(labels = c("Revised estimate", "Raw estimate"))
labs(
title = "Sheets needed per year, raw vs. revised",
x = "Year",
y = "Required number of sheets"
)
yearly_data %<>%
left_join(num_known) %>%
mutate(revised = sheets_needed / known_vols)
yearly_data
yearly_data %>%
select(-known_vols) %>%
gather(metric, measure, -order_year) %>%
ggplot(aes(order_year, measure, color = metric)) +
geom_line() +
scale_y_continuous(labels = comma) +
scale_x_continuous(breaks = seq(1770, 1794, by = 4)) +
scale_color_discrete(labels = c("Revised estimate", "Raw estimate"))
labs(
title = "Sheets needed per year, raw vs. revised",
x = "Year",
y = "Required number of sheets",
colour = "Legend"
)
yearly_data %<>%
left_join(num_known) %>%
mutate(revised = sheets_needed / known_vols)
yearly_data
yearly_data %>%
select(-known_vols) %>%
gather(metric, measure, -order_year) %>%
ggplot(aes(order_year, measure, color = metric)) +
geom_line() +
scale_y_continuous(labels = comma) +
scale_x_continuous(breaks = seq(1770, 1794, by = 4)) +
scale_color_discrete(labels = c("Revised estimate", "Raw estimate")) +
labs(
title = "Sheets needed per year, raw vs. revised",
x = "Year",
y = "Required number of sheets",
colour = "Legend"
)
# Why is 1782 so high?
transactions %>%
filter(order_year == 1781) %>%
group_by(book_code) %>%
mutate(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
slice(1) %>%
ungroup() %>%
select(full_book_title, total_pages, edition, total_sheets, number_of_volumes, num_vols_exchanged, sheets_needed) %>%
print(n = Inf)
# Why is 1782 so high?
transactions %>%
filter(order_year == 1781) %>%
group_by(book_code) %>%
mutate(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
slice(1) %>%
ungroup() %>%
select(full_book_title, total_pages, edition, total_sheets, number_of_volumes, num_vols_exchanged, sheets_needed) %>%
arrange(desc(num_vols_exchanged)) %>%
print(n = Inf)
# Why is 1782 so high?
transactions %>%
filter(order_year == 1781) %>%
group_by(book_code) %>%
mutate(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
slice(1) %>%
ungroup() %>%
select(full_book_title, total_pages, edition, total_sheets, number_of_volumes, num_vols_exchanged, sheets_needed) %>%
arrange(desc(num_vols_exchanged)) %>%
.$sheets_needed %>%
sum()
# Why is 1782 so high?
transactions %>%
filter(order_year == 1781) %>%
group_by(book_code) %>%
mutate(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
slice(1) %>%
ungroup() %>%
select(full_book_title, total_pages, edition, total_sheets, number_of_volumes, num_vols_exchanged, sheets_needed) %>%
arrange(desc(num_vols_exchanged)) %>%
.$sheets_needed %>%
sum(na.rm = T)
# Or a faceted lined graph
format_labeller = as_labeller(c(
"2" = "2 (folio)",
"4" = "4 (quarto)",
"8" = "8 (octavo)",
"12" = "12 (duodecimo)"
))
transactions %>%
filter(!is.na(edition)) %>%
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
ggplot(aes(order_year, num_vols_exchanged)) +
facet_wrap(~edition, scales = "free_y", labeller = format_labeller) +
scale_x_continuous(breaks = seq(1770, 1794, by = 4)) +
geom_line() +
labs(
title = "Demand for all formats except folio peaked in the late 70s or early 80s",
subtitle = "Number of volumes exchaged by number of leaves (NB: y axes on different scales)"
)
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code) %>%
mutate(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
slice(1) %>%
ungroup() %>%
select(full_book_title, total_pages, edition, total_sheets, number_of_volumes, num_vols_exchanged, sheets_needed) %>%
arrange(desc(num_vols_exchanged)) %>%
.$sheets_needed %>%
sum()
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code) %>%
mutate(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
slice(1) %>%
ungroup() %>%
select(full_book_title, total_pages, edition, total_sheets, number_of_volumes, num_vols_exchanged, sheets_needed) %>%
arrange(desc(num_vols_exchanged)) %>%
.$sheets_needed %>%
sum(na.rm = T)
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code) %>%
mutate(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
slice(1) %>%
ungroup() %>%
select(full_book_title, total_pages, edition, total_sheets, number_of_volumes, num_vols_exchanged, sheets_needed) %>%
arrange(desc(num_vols_exchanged))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code) %>%
summarise(-full_book_title, -book_code,
sheets_needed = sum(sheets_needed, na.rm = T),
num_vols_exchanged = sum(num_vols_exchanged, na.rm = T))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code) %>%
summarise(sheets_needed = sum(sheets_needed, na.rm = T),
num_vols_exchanged = sum(num_vols_exchanged, na.rm = T))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title) %>%
summarise(sheets_needed = sum(sheets_needed, na.rm = T),
num_vols_exchanged = sum(num_vols_exchanged, na.rm = T))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title) %>%
summarise(sheets_needed = sum(sheets_needed, na.rm = T),
copies_exchanged = sum(num_vols_exchanged, na.rm = T) / number_of_volumes) %>%
mutate(total_sheets = sheets_needed * num_vols_exchanged) %>%
arrange(desc(total_sheets))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title) %>%
summarise(sheets_needed = sum(sheets_needed, na.rm = T),
copies_exchanged = sum(num_vols_exchanged, na.rm = T) / number_of_volumes[1]) %>%
mutate(total_sheets = sheets_needed * num_vols_exchanged) %>%
arrange(desc(total_sheets))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, number_of_volumes) %>%
summarise(sheets_needed = sum(sheets_needed, na.rm = T),
copies_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
mutate(total_sheets = sheets_needed * num_vols_exchanged / number_of_volumes) %>%
arrange(desc(total_sheets))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, number_of_volumes) %>%
summarise(sheets_needed = sum(sheets_needed, na.rm = T),
num_volumes_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
mutate(total_sheets = sheets_needed * num_vols_exchanged / number_of_volumes) %>%
arrange(desc(total_sheets))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, number_of_volumes) %>%
summarise(sheets_needed = sum(sheets_needed, na.rm = T),
num_vols_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
mutate(total_sheets = sheets_needed * num_vols_exchanged / number_of_volumes) %>%
arrange(desc(total_sheets))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, number_of_volumes, sheets_needed) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T)) %>%
mutate(total_sheets = sheets_needed * num_vols_exchanged / number_of_volumes) %>%
arrange(desc(total_sheets))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T), -full_book_title)
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code) %>%
mutate(num_vols_exchanged = sum(num_vols_exchanged)) %>%
slice(1)
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code) %>%
summarise(total_sheets = sum(total_sheets, na.rm = T))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, edition) %>%
summarise(total_sheets = sum(total_sheets, na.rm = T))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, edition) %>%
summarise(total_sheets = sum(total_sheets, na.rm = T)) %>%
arrange(desc(total_sheets))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, edition) %>%
summarise(total_sheets = sum(total_sheets, na.rm = T)) %>%
arrange(desc(total_sheets)) %>%
.$total_sheets %>%
sum()
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, edition) %>%
summarise(sheets_needed = sum(sheets_needed, na.rm = T)) %>%
arrange(desc(sheets_needed)) %>%
.$sheets_needed %>%
sum()
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, edition) %>%
summarise(sheets_needed = sum(sheets_needed, na.rm = T)) %>%
arrange(desc(sheets_needed))
# Why is 1782 so high?
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T),
sheets_needed = sum(sheets_needed, na.rm = T)) %>%
arrange(desc(sheets_needed))
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T),
sheets_needed = sum(sheets_needed, na.rm = T)) %>%
arrange(desc(sheets_needed))
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T),
sheets_needed = sum(sheets_needed, na.rm = T)) %>%
arrange(desc(sheets_needed)) %>%
select(everything(), book_code)
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T),
sheets_needed = sum(sheets_needed, na.rm = T)) %>%
arrange(desc(sheets_needed))
transactions %>%
filter(order_year == 1782) %>%
group_by(book_code, full_book_title, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged, na.rm = T),
sheets_needed = sum(sheets_needed, na.rm = T)) %>%
arrange(desc(sheets_needed)) %>%
select(book_code, edition, num_vols_exchanged, sheets_needed, full_book_title)
transactions %>%
mutate(order_year = cut(order_year, 5, labels = c("1770-74", "1775-79", "1780-1784", "1785-1789", "1790-94"))) %>% # split data into three-year increments to make it easier to visualise
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
replace_na(list(edition = "Unknown")) %>% # replace NAs in edition column
drop_na() %T>% # drop the rows with missing years
print(n = Inf) %>%
ggplot(aes(order_year, num_vols_exchanged, fill = as.character(edition))) +
geom_col(position = "dodge")
transactions %>%
mutate(order_year = cut(order_year, 5, labels = c("1770-74", "1775-79", "1780-1784", "1785-1789", "1790-94"))) %>% # split data into three-year increments to make it easier to visualise
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
replace_na(list(edition = "Unknown")) %>% # replace NAs in edition column
drop_na() %T>% # drop the rows with missing years
print(n = Inf) %>%
ggplot(aes(order_year, num_vols_exchanged, fill = as.character(edition))) +
geom_col(position = "dodge") +
scale_color_discrete(labeller = format_labeller) +
labs(
title = "Demand for all formats except folio appears to have peaked\nin the early 1780s.",
x = "Year",
y = "Number of volumes sold",
fill = "Format"
)
?scale_color_discrete
transactions %>%
mutate(order_year = cut(order_year, 5, labels = c("1770-74", "1775-79", "1780-1784", "1785-1789", "1790-94"))) %>% # split data into three-year increments to make it easier to visualise
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
replace_na(list(edition = "Unknown")) %>% # replace NAs in edition column
drop_na() %T>% # drop the rows with missing years
print(n = Inf) %>%
ggplot(aes(order_year, num_vols_exchanged, fill = as.character(edition))) +
geom_col(position = "dodge") +
scale_color_discrete(labels = c(
"2" = "2 (folio)",
"4" = "4 (quarto)",
"8" = "8 (octavo)",
"12" = "12 (duodecimo)"
)) +
labs(
title = "Demand for all formats except folio appears to have peaked\nin the early 1780s.",
x = "Year",
y = "Number of volumes sold",
fill = "Format"
)
transactions %>%
mutate(order_year = cut(order_year, 5, labels = c("1770-74", "1775-79", "1780-1784", "1785-1789", "1790-94"))) %>% # split data into three-year increments to make it easier to visualise
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
replace_na(list(edition = "Unknown")) %>% # replace NAs in edition column
drop_na() %T>% # drop the rows with missing years
print(n = Inf) %>%
ggplot(aes(order_year, num_vols_exchanged, fill = as.character(edition))) +
geom_col(position = "dodge") +
scale_color_discrete(labels = c(
"2 (folio)",
"4 (quarto)",
"8 (octavo)",
"12 (duodecimo)"
)) +
labs(
title = "Demand for all formats except folio appears to have peaked\nin the early 1780s.",
x = "Year",
y = "Number of volumes sold",
fill = "Format"
)
transactions %>%
mutate(order_year = cut(order_year, 5, labels = c("1770-74", "1775-79", "1780-1784", "1785-1789", "1790-94"))) %>% # split data into three-year increments to make it easier to visualise
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
replace_na(list(edition = "Unknown")) %>% # replace NAs in edition column
drop_na() %T>% # drop the rows with missing years
print(n = Inf) %>%
ggplot(aes(order_year, num_vols_exchanged, fill = as.character(edition))) +
geom_col(position = "dodge") +
scale_color_discrete(labels = c(
"2 (folio)",
"4 (quarto)",
"8 (octavo)",
"12 (duodecimo)"
)) +
labs(
title = "Demand for all formats except folio appears to have peaked\nin the early 1780s.",
x = "Year",
y = "Number of volumes sold",
fill = "Format"
)
transactions %>%
mutate(order_year = cut(order_year, 5, labels = c("1770-74", "1775-79", "1780-1784", "1785-1789", "1790-94"))) %>% # split data into three-year increments to make it easier to visualise
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
replace_na(list(edition = "Unknown")) %>% # replace NAs in edition column
drop_na() %T>% # drop the rows with missing years
print(n = Inf) %>%
ggplot(aes(order_year, num_vols_exchanged, fill = as.character(edition))) +
geom_col(position = "dodge") +
scale_fill_discrete(labels = c(
"2 (folio)",
"4 (quarto)",
"8 (octavo)",
"12 (duodecimo)"
)) +
labs(
title = "Demand for all formats except folio appears to have peaked\nin the early 1780s.",
x = "Year",
y = "Number of volumes sold",
fill = "Format"
)
transactions %>%
mutate(order_year = cut(order_year, 5, labels = c("1770-74", "1775-79", "1780-1784", "1785-1789", "1790-94"))) %>% # split data into three-year increments to make it easier to visualise
group_by(order_year, edition) %>%
summarise(num_vols_exchanged = sum(num_vols_exchanged)) %>%
replace_na(list(edition = "Unknown")) %>% # replace NAs in edition column
drop_na() %T>% # drop the rows with missing years
print(n = Inf) %>%
ggplot(aes(order_year, num_vols_exchanged, fill = as.character(edition))) +
geom_col(position = "dodge") +
scale_fill_discrete(labels = c(
"2 (folio)",
"4 (quarto)",
"8 (octavo)",
"12 (duodecimo)",
"Unknown"
)) +
labs(
title = "Demand for all formats except folio appears to have peaked\nin the early 1780s.",
x = "Year",
y = "Number of volumes sold",
fill = "Format"
)
