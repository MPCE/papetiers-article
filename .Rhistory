summarise(n = n()) %>%
ggplot(aes(date, n)) %>%
geom_col()
geom_col
?geom_col
letters %>%
mutate(
date = lubridate::ymd(date),
month = month(date),
year = year(date)
)
month
letters %>%
mutate(
date = lubridate::ymd(date),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
ggplot(aes(date, n)) %>%
geom_col()
letters %>%
mutate(
date = lubridate::ymd(date)#,
# month = lubridate::month(date),
# year = lubridate::year(date)
)
lubridate::ymd()
lubridate::ymd
?ymd
?lubridate::month
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
ggplot(aes(date, n)) %>%
geom_col()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
ggplot(aes(date, n)) +
geom_col()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date),
date = as.character(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
ggplot(aes(date, n)) +
geom_col()
rlang::last_error()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date),
date = as.character(date)
)
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date),
year_month = paste0(year, month)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
ggplot(aes(year_month, n)) +
geom_col()
geom_bar
?geom_bar
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date),
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
complete(year, month, 0)
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date),
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
complete(year, month, fill = 0)
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date),
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
complete(year, month)
ggplot(aes(year_month, n)) +
geom_col()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date),
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
complete(year, month)
letters <- read_xlsx('data/papetier_out_letter_locations_all_dates.xlsx') %>%
mutate(include = replace_na(include, "yes")) %>%
filter(include != "no") # Exclude letters that SB has deemed irrelevant to the paper trade
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date),
) %>%
group_by(year, month) %>%
summarise(n = n())
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
# Add in rows for missing months
full_join(tibble(year = 1769:1789, month = 1:12), by = c("year","month")) %>%
ggplot(aes(year_month, n)) +
geom_col()
rep(1:12, 21)
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
# Add in rows for missing months
full_join(tibble(year = 1769:1789, month = rep(1:12, 1789-1769+1)), by = c("year","month")) %>%
ggplot(aes(year_month, n)) +
geom_col()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
# Add in rows for missing months
full_join(tibble(year = rep(1769:1789, 12), month = rep(1:12, 21)), by = c("year","month")) %>%
ggplot(aes(year_month, n)) +
geom_col()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
# Add in rows for missing months
full_join(tibble(year = rep(1769:1789, 12), month = rep(1:12, 21)), by = c("year","month")) %>%
arrange(year, month) %>%
mutate(year_month = paste0(year, month)) %>%
ggplot(aes(year_month, n)) +
geom_col()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
drop_na() %>%
# Add in rows for missing months
full_join(tibble(year = rep(1769:1789, 12), month = rep(1:12, 21)), by = c("year","month")) %>%
arrange(year, month) %>%
mutate(year_month = paste0(year, month)) %>%
ggplot(aes(year_month, n)) +
geom_col()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
drop_na() %>%
# Add in rows for missing months
full_join(tibble(year = rep(1769:1789, 12), month = rep(1:12, 21)), by = c("year","month")) %>%
replace_na(0) %>%
arrange(year, month) %>%
mutate(year_month = paste0(year, month)) %>%
ggplot(aes(year_month, n)) +
geom_col()
?replace(na)
?replace_na
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
drop_na() %>%
# Add in rows for missing months
full_join(tibble(year = rep(1769:1789, 12), month = rep(1:12, 21)), by = c("year","month")) %>%
replace_na(list(n = 0)) %>%
arrange(year, month) %>%
mutate(year_month = paste0(year, month)) %>%
ggplot(aes(year_month, n)) +
geom_col()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
drop_na() %>%
# Add in rows for missing months
full_join(tibble(year = rep(1769:1789, 12), month = rep(1:12, 21)), by = c("year","month")) %>%
replace_na(list(n = 0)) %>%
arrange(year, month) %>%
mutate(year_month = paste0(year, month)) %>%
ggplot(aes(year_month, n)) +
geom_col() +
theme_minimal()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
drop_na() %>%
# Add in rows for missing months
full_join(tibble(year = rep(1769:1789, 12), month = rep(1:12, 21)), by = c("year","month")) %>%
replace_na(list(n = 0)) %>%
arrange(year, month) %>%
mutate(year_month = paste0(year, month)) %>%
ggplot(aes(year_month, n)) +
geom_col() +
ggthemes::theme_tufte()
library(lubridate)
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
sumarise(n = n()) %>%
ggplot(aes(date, n)) +
geom_col()
library(lubridate)
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
ggplot(aes(date, n)) +
geom_col()
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`),
month = month(date),
year = year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
ggplot(aes(date, n)) +
geom_col()
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`),
month = month(date),
year = year(date)
)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`),
month = month(date),
year = year(date)
) %>%
group_by(year, month) %>%
summarise(n = n())
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`),
month = month(date),
year = year(date)
) %>%
group_by(date, year, month) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(date, n)) +
geom_col()
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n()) %>%
drop_na() %>%
# Add in rows for missing months
full_join(tibble(year = rep(1769:1789, 12), month = rep(1:12, 21)), by = c("year","month")) %>%
replace_na(list(n = 0)) %>%
arrange(year, month) %>%
mutate(year_month = paste0(year, month)) %>%
ggplot(aes(year_month, n)) +
geom_col() +
ggthemes::theme_tufte() +
scale_x
letters %>%
mutate(
date = lubridate::ymd(`date (YYYYMMDD)`),
month = lubridate::month(date),
year = lubridate::year(date)
) %>%
group_by(year, month) %>%
summarise(n = n())
?scale_x_date
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`),
month = month(date),
year = year(date)
) %>%
group_by(date, year, month) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(date, n)) +
scale_x_date(date_breaks = "1 month")
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
ggplot(aes(date, n)) +
scale_x_date(date_breaks = "1 month")
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
ggplot(aes(date)) +
grom_bar() +
scale_x_date(date_breaks = "1 month")
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
ggplot(aes(date)) +
geom_bar() +
scale_x_date(date_breaks = "1 month")
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
ggplot(aes(date)) +
geom_bar() +
scale_x_date(date_breaks = "1 month", date_labels = "%Y")
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
ggplot(aes(date)) +
geom_bar() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y")
?geom_bar
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(date, year(date), month(date)) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(date, n)) +
geom_col() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y")
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(date, year(date), month(date)) %>%
summarise(n = n()) %>%
ungroup()
ceiling_date()
ceiling_date
?ceiling_date
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(date, ceiling_date(date, unit = "quarter")) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(date, n)) +
geom_col() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y")
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(date, quarter = ceiling_date(date, unit = "quarter")) %>%
summarise(n = n()) %>%
ungroup()
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(date, quarter = ceiling_date(date, unit = "quarter")) %>%
summarise(n = n())
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(date, quarter = ceiling_date(date, unit = "quarter"))
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(date, quarter = ceiling_date(date, unit = "quarter")) %>%
summarise(n = n()) %>%
pull(n) %>% sum(na.rm = T)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(date, quarter = ceiling_date(date, unit = "quarter")) %>%
summarise(n = n())
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(quarter = ceiling_date(date, unit = "quarter")) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(date, n)) +
geom_col() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y")
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(quarter = ceiling_date(date, unit = "quarter")) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(quarter, n)) +
geom_col() +
scale_x_date(date_breaks = "1 year", date_labels = "%Y")
library(lubridate)
letters %>%
mutate(
date = ymd(`date (YYYYMMDD)`)
) %>%
group_by(quarter = ceiling_date(date, unit = "quarter")) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(quarter, n)) +
geom_col() +
scale_x_date(date_breaks = "3 years", date_labels = "%Y")
library(lubridate)
letters %>%
mutate(
quarter = ymd(`date (YYYYMMDD)`) %>% ceiling_date(unit = "quarter")
) %>%
group_by(quarter) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(quarter, n)) +
geom_col() +
scale_x_date(date_breaks = "3 years", date_labels = "%Y")
